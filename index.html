<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nocturne Library — Global Infinite</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .glow { text-shadow: 0 0 90px #c41e3a; }
    .orb { animation: float 25s infinite ease-in-out; }
    @keyframes float { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-40px); } }
    .book { opacity: 0; transform: translateY(50px); animation: rise 1s forwards; }
    @keyframes rise { to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body class="bg-[#0f0f12] text-white min-h-screen overflow-x-hidden">

  <div class="fixed inset-0 -z-10 overflow-hidden pointer-events-none">
    <div class="absolute inset-0 bg-gradient-to-br from-[#0f0f12] via-[#1a0010] to-[#001022]"></div>
    <div class="orb absolute w-[800px] h-[800px] rounded-full mix-blend-screen opacity-20" style="top:-20%;left:-10%;background:radial-gradient(circle,rgba(196,30,58,0.25),transparent 70%)"></div>
    <div class="orb absolute w-[900px] h-[900px] rounded-full mix-blend-screen opacity-15" style="bottom:-20%;right:-10%;background:radial-gradient(circle,rgba(15,76,129,0.2),transparent 70%)"></div>
  </div>

  <!-- Hero + Controls -->
  <section id="hero" class="min-h-screen flex flex-col items-center justify-center px-6 text-center">
    <div class="space-y-16 max-w-6xl">

      <h1 class="text-8xl md:text-9xl font-black bg-gradient-to-r from-[#c41e3a] via-white to-[#0f4c81] bg-clip-text text-transparent font-playfair glow">
        Nocturne Library
      </h1>
      <p id="motto" class="text-3xl md:text-5xl font-cinzel text-gray-300">ANY GENRE · ANY LANGUAGE · ANY COUNTRY</p>

      <!-- Language / Country / Genre -->
      <div class="flex flex-wrap justify-center gap-4">
        <select id="lang" class="px-6 py-3 bg-black/60 border border-white/20 rounded-full text-lg font-cinzel">
          <option value="en">English</option>
          <option value="fr">Français</option>
          <option value="es">Español</option>
          <option value="de">Deutsch</option>
          <option value="it">Italiano</option>
          <option value="ja">日本語</option>
          <option value="ru">Русский</option>
          <option value="pt">Português</option>
          <option value="zh">中文</option>
          <option value="ko">한국어</option>
        </select>

        <select id="country" class="px-6 py-3 bg-black/60 border border-white/20 rounded-full text-lg font-cinzel">
          <option value="">Worldwide</option>
          <option value="US">USA</option>
          <option value="GB">UK</option>
          <option value="FR">France</option>
          <option value="DE">Germany</option>
          <option value="JP">Japan</option>
          <option value="IN">India</option>
          <option value="BR">Brazil</option>
        </select>

        <select id="genre" class="px-6 py-3 bg-black/60 border border-white/20 rounded-full text-lg font-cinzel">
          <option value="Fantasy">Fantasy</option>
          <option value="Gothic Horror">Gothic Horror</option>
          <option value="Romance">Romance</option>
          <option value="Science Fiction">Science Fiction</option>
          <option value="Mystery">Mystery & Thriller</option>
          <option value="Dark Academia">Dark Academia</option>
          <option value="Historical Fiction">Historical</option>
          <option value="Philosophy">Philosophy</option>
          <option value="Dystopian">Dystopian</option>
          <option value="Young Adult">Young Adult</option>
          <option value="Poetry">Poetry</option>
          <option value="Horror">Horror</option>
        </select>
      </div>

      <!-- Manual search added -->
      <input id="manualSearch" type="198" placeholder="Or type anything you crave..." 
             class="w-full max-w-2xl px-8 py-5 bg-black/60 backdrop-blur-xl border border-white/20 rounded-3xl text-xl text-center outline-none placeholder-gray-500"/>

      <button onclick="start()" class="px-20 py-6 bg-[#c41e3a] hover:bg-[#c41e3a]/90 rounded-3xl font-bold text-2xl shadow-2xl shadow-[#c41e3a]/50 transition hover:scale-105">
        Enter the Infinite Void
      </button>

    </div>
  </section>

  <!-- Infinite Results -->
  <section id="results" class="hidden py-20 px-6">
    <div class="max-w-screen-2xl mx-auto">
      <button onclick="location.reload()" class="mb-12 text-red-500 hover:text-white text-xl font-cinzel">← Return</button>
      <h2 id="title" class="text-7xl text-center mb-20 font-playfair bg-gradient-to-r from-red-600 to-blue-600 bg-clip-text text-transparent">Fantasy</h2>
      <div id="grid" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 gap-6"></div>
      <div class="text-center py-16 text-3xl text-gray-500" id="loading">Summoning more tomes...</div>
    </div>
  </section>

  <script>
    const quotes = [
      "WHISPER YOUR DARKEST DESIRES INTO THE VOID...",
      "THE LIBRARY NEVER SLEEPS...",
      "EVERY BOOK YOU EVER CRAVED IS WAITING...",
      "ONE CLICK. ETERNAL DARKNESS.",
      "THE SHADOWS KNOW WHAT YOU WANT.",
      "ENTER IF YOU DARE TO READ FOREVER.",
      "THE VOID IS LISTENING...",
      "YOUR NEXT OBSESSION IS HERE.",
      "BOOKS THAT HAUNT. BOOKS THAT STAY.",
      "DESCEND INTO INFINITE PAGES."
    ];
    document.getElementById('motto').textContent = quotes[Math.floor(Math.random()*quotes.length)];

    let baseQuery = 'Fantasy', index = 0, loading = false;
    const perPage = 40;

    function start() {
      const manual = document.getElementById('manualSearch').value.trim();
      baseQuery = manual || document.getElementById('genre').value;
      document.getElementById('title').textContent = manual || baseQuery;
      document.getElementById('hero').classList.add('hidden');
      document.getElementById('results').classList.remove('hidden');
      document.getElementById('grid').innerHTML = '';
      index = 0;
      fetchBooks();
      window.onscroll = () => {
        if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 1200 && !loading) fetchBooks();
      };
    }

    async function fetchBooks() {
      if (loading) return;
      loading = true;
      document.getElementById('loading').style.display = 'block';

      const lang = document.getElementById('lang').value;
      const country = document.getElementById('country').value;

      let q = baseQuery ? `subject:"${baseQuery}"` : '';
      if (lang !== 'en') q += `&lr=lang_${lang}`;
      if (country) q += `&cr=country${country}`;

      const url = `https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(q)}&startIndex=${index}&maxResults=${perPage}&orderBy=relevance&printType=books`;
      const res = await fetch(url);
      const data = await res.json();

      const grid = document.getElementById('grid');
      (data.items || []).forEach((item, i) => {
        const b = item.volumeInfo;
        const img = (b.imageLinks?.thumbnail || '').replace('http://','https://') || 'https://via.placeholder.com/300x450/111/fff?text=...';
        const div = document.createElement('div');
        div.className = 'book';
        div.style.animationDelay = `${i * 40}ms`;
        div.innerHTML = `
          <div class="group relative rounded-2xl overflow-hidden border border-white/10 hover:border-red-600 transition">
            <img src="${img}" class="w-full aspect-[3/4.5] object-cover group-hover:scale-110 transition duration-1000">
            <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent opacity-0 group-hover:opacity-100 transition">
              <div class="absolute bottom-0 p-3 text-left">
                <h3 class="text-sm font-bold line-clamp-2">${b.title}</h3>
                <p class="text-xs text-blue-400">${b.authors?.[0] || ''}</p>
              </div>
            </div>
          </div>`;
        grid.appendChild(div);
      });

      index += perPage;
      loading = false;
      document.getElementById('loading').style.display = data.items?.length < perPage ? 'none' : 'block';
    }

    // Auto-refresh when language/country changes
    document.getElementById('lang').addEventListener('change', () => { if (document.getElementById('results').classList.contains('hidden') === false) { index = 0; document.getElementById('grid').innerHTML = ''; fetchBooks(); } });
    document.getElementById('country').addEventListener('change', () => { if (document.getElementById('results').classList.contains('hidden') === false) { index = 0; document.getElementById('grid').innerHTML = ''; fetchBooks(); } });
    document.getElementById('genre').addEventListener('change', () => { if (document.getElementById('results').classList.contains('hidden') === false) start(); });
    
    // Manual search on Enter
    document.getElementById('manualSearch').addEventListener('keypress', e => { if (e.key === 'Enter') start(); });
  </script>
</body>
</html>
